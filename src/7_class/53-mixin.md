※gptまんまなので注意

# Mixin vs コンポジション 判定ガイド（README）

## 目的

このドキュメントは、Python設計において\
**Mixinを使うべきか / コンポジションを使うべきか**\
を迷わず判断できるようにするための実務向け指針です。

------------------------------------------------------------------------

## 結論サマリ（最短判断）

  質問                               YES              NO
  ---------------------------------- ---------------- ----------------
  振る舞いを「横から足す」だけか？   Mixin            次へ
  状態（フィールド）を持つか？       コンポジション   次へ
  差し替え・テストが必要か？         コンポジション   次へ
  単体では意味を持たないか？         Mixin            コンポジション

------------------------------------------------------------------------

## Mixinを選ぶべき条件

### 使って良いケース

-   状態を持たない
-   `__init__` を定義しない
-   単体では使われない
-   横断的な振る舞い（logging, serialize, validate 等）

``` python
class JsonMixin:
    def to_json(self):
        ...
```

### NGサイン

-   フィールドを持ち始めた
-   初期化順序を意識し始めた
-   `super()` を深く理解していないと壊れる

→ **この時点で設計ミスの可能性大**

------------------------------------------------------------------------

## コンポジションを選ぶべき条件

### 使うべきケース

-   明確な責務を持つ
-   状態を保持する
-   実装を将来差し替えたい
-   テストでモックしたい

``` python
class UserService:
    def __init__(self, logger):
        self.logger = logger
```

### メリット

-   多重継承不要
-   MROを考えなくていい
-   設計の意図が読みやすい

------------------------------------------------------------------------

## 判断フローチャート（文章版）

1.  これは「〜である（is-a）」か？
    -   YES → 継承（単一）
    -   NO → 次へ
2.  これは「〜を使う（has-a）」か？
    -   YES → コンポジション
3.  横断的な便利機能か？
    -   YES → Mixin（条件付き）

------------------------------------------------------------------------

## 実務ルール（推奨）

-   デフォルトは **コンポジション**
-   Mixinは「状態なし・横断機能のみ」
-   多重継承はMixin以外で使わない
-   迷ったら「後から消せるか？」で判断

------------------------------------------------------------------------

## よくある失敗例

❌ Mixinがビジネスロジックを持つ\
❌ Mixin同士が依存し始める\
❌ コンポジションなのに継承している

------------------------------------------------------------------------

## まとめ

-   **Mixin = 振る舞いの追加**
-   **コンポジション = 責務の組み合わせ**
-   設計で迷ったら「差し替えたいか？」を問う

以上。
